{"meta":{"title":"littlepig flying","subtitle":null,"description":"生活如此美好~~","author":"miracle li","url":"http://www.blog.littlepig.tech"},"pages":[{"title":"categories","date":"2018-06-14T01:22:04.000Z","updated":"2018-06-14T09:43:16.262Z","comments":true,"path":"categories/index.html","permalink":"http://www.blog.littlepig.tech/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-06-14T01:21:35.000Z","updated":"2018-06-14T09:44:51.401Z","comments":true,"path":"tags/index.html","permalink":"http://www.blog.littlepig.tech/tags/index.html","excerpt":"","text":""},{"title":"about","date":"2018-06-13T09:16:31.000Z","updated":"2018-06-13T09:17:05.989Z","comments":true,"path":"about/index.html","permalink":"http://www.blog.littlepig.tech/about/index.html","excerpt":"","text":"本文链接：&lt;%= post.title %&gt; 作者：令狐葱 出处：http://jiji262.github.io/本文基于 知识共享署名-相同方式共享 4.0 国际许可协议发布，欢迎转载，演绎或用于商业目的，但是必须保留本文的署名令狐葱及链接。"}],"posts":[{"title":"Cloudera 5.13.3 离线安装","slug":"Cloudera 安装","date":"2018-05-01T13:01:24.000Z","updated":"2018-06-14T09:46:00.479Z","comments":true,"path":"2018/05/01/Cloudera 安装/","link":"","permalink":"http://www.blog.littlepig.tech/2018/05/01/Cloudera 安装/","excerpt":"","text":"离线安装cloudera 5.13.3本版本的cloudera默认自带spark1.6 升级到spark2 软件版本说明 服务器版本 3.10.0-327.el7.centos cloudera 5.13.3 cloudera manager 5.13.3 下文简称CM jdk 1.8.0_172 mysql 5.7.17 相应包下载地址 cm镜像地址 http://archive.cloudera.com/cm5/cm/5/cloudera-manager-centos7-cm5.13.3_x86_64.tar.gz CDH镜像地址：(注意与服务器版本保持一致，我的是centos el7 所以下载el7的包) http://archive.cloudera.com/cdh5/parcels/5.13.3/CDH-5.13.3-1.cdh5.13.3.p0.2-el7.parcelhttp://archive.cloudera.com/cdh5/parcels/5.13.3/CDH-5.13.3-1.cdh5.13.3.p0.2-el7.parcel.sha1http://archive.cloudera.com/cdh5/parcels/5.13.3/manifest.json mysql 下载地址 在镜像http://mirrors.sohu.com/mysql/MySQL-5.7/中下载相应包mysql-community-client-5.7.17-1.el7.x86_64.rpmmysql-community-libs-5.7.17-1.el7.x86_64.rpmmysql-community-common-5.7.17-1.el7.x86_64.rpmmysql-community-libs-compat-5.7.21-1.el7.x86_64.rpmmysql-community-server-5.7.21-1.el7.x86_64.rpmhttp://dev.mysql.com/downloads/connector/j/ 下载mysql 的jdbc驱动 环境配置 网络配置（所有节点） 修改各个主机名，主机名不要有下划线，我这是6台机器，主机名分别是hadoop0~hadoop51$ vi /etc/hostname 修改network 并使之生效1234567vi /etc/sysconfig/network修改为：NETWORKING=yesHOSTNAME=hadoopX使之生效：source /etc/sysconfig/network 修改hosts12345678vi /etc/hosts添加：10.10.XX.130 hadoop010.10.XX.131 hadoop110.10.XX.132 hadoop210.10.XX.133 hadoop310.10.XX.134 hadoop410.10.XX.135 hadoop5 重启网络1$service network restart 设置SSH免密登录（所有节点） 在所有节点执行1234567891011121314每台机器执行，一直回车 生成无密码密钥$ssh-keygen -t rsa将公钥添加到认证文件中：cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys 设置authorized_keys的访问权限：chmod 600 ~/.ssh/authorized_keys将密钥发送到其他需要免密登录的机器中 每台机器都要执行比如 在hadoop0 中执行时要执行5次，修改hadoop1 ~hadoop5cat ~/.ssh/id_rsa.pub | ssh -p 22 root@hadoop1 ‘cat &gt;&gt; ~/.ssh/authorized_keys’测试 在hadoop0 中执行ssh hadoop1不需要密码登录到hadoop1中 关闭防火墙 (所有节点)1234//临时关闭systemctl stop firewalld//禁止开机启动systemctl disable firewalld 设置集群时间同步 （所有节点）1234567891011121314151.在集群中所有节点上安装ntpyum install ntp2.所有节点设置时区，这里设置为中国所用时间timedatectl set-timezone Asia/Shanghai3.在server节点上启动ntp服务systemctl start ntpdsystemctl enable ntpd4.在server节点上设置现在的准确时间timedatectl set-time HH:MM:SS5.在server节点上设置其ntp服务器为其自身，同时设置可以接受连接服务的客户端，是通过更改/etc/ntp.conf文件来实现的，其中server设置127.127.1.0为其自身vi /etc/ntp.conf 123456.重启ntpd服务systemctl restart ntpd7.在client节点上设置ntp服务器为server节点vi /etc/ntp.conf 123456789108.在client节点上同步server的时间ntpdate hadoop09.client节点启动ntpd服务systemctl start ntpdsystemctl enable ntpd10.所有节点启动时间同步timedatectl set-ntp yes 安装 jdk （所有节点）注意一定放在/usr/java/下！！！123456789101112131415161718191.卸载自带的OpenJdkrpm -qa | grep java #查询java相关的包rpm -e --nodeps XXX #包名卸载之。2. 创建解压目录mkdir -p /usr/java/3. 在jdk压缩包所在目录下执行tar -zxvf jdk-8u172-linux-x64.tar.gz -C /usr/java/4、修改环境变量vi /etc/profile添加：export JAVA_HOME=/usr/java/jdk1.8.0_172export JRE_HOME=$JAVA_HOME/jreexport CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib/tools.jarexport PATH=$JAVA_HOME/bin:$PATH5、使之生效source /etc/profile6、验证java -version显示正确版本号 安装 mysql （主节点）123456789101112131415161718192021222324251. centos 7 默认安装的是mariadb，需要先卸载再安装rpm -qa | grep mariadb #查看安装信息rpm -e mariadb-libs* --nodeps #根据查找到的软件包信息卸载2. 安装mysqlyum install libnuma*rpm -ivh mysql-community-common-5.7.17-1.el7.x86_64.rpmrpm -ivh mysql-community-libs-5.7.17-1.el7.x86_64.rpmrpm -ivh mysql-community-client-5.7.17-1.el7.x86_64.rpmrpm -ivh mysql-community-server-5.7.17-1.el7.x86_64.rpm3. 设置开机启动chkconfig mysqld on #开机启动service mysqld start #启动mysql服务，mysqladmin -u root password &apos;xxxx&apos; #设置root密码4、进入mysql命令myslq -uroot -p #输入密码进入mysql控制台5、创建数据库create database hue DEFAULT CHARSET utf8 COLLATE utf8_general_ci; #hivecreate database hive DEFAULT CHARSET utf8 COLLATE utf8_general_ci;#activity monitorcreate database amon DEFAULT CHARSET utf8 COLLATE utf8_general_ci;create database oozie DEFAULT CHARSET utf8 COLLATE utf8_general_ci;6. 授权root用户在主节点拥有所有数据库的访问权限grant all privileges on *.* to &apos;root&apos;@&apos;n1&apos; identified by &apos;xxxx&apos; with grant option;flush privileges; 安装 cm+cdh 主节点解压cloudera-manager-centos7-cm5.13.3_x86_64.tar.gz 到/opt下 1tar -zxvf cloudera-manager-centos7-cm5.13.3_x86_64.tar.gz -C /opt/ 为cm 建立mysql数据库 1234561. 将下载的mysql jdbc驱动包解压，并将 jar复制到 cm相应目录下tar -zxvf mysql-connector-java-5.1.45.tar.gzcp mysql-connector-java-5.1.45-bin.jar /opt/cm-5.13.3/share/cmf/lib2.在主节点初始化cm数据库/opt/cm-5.13.3/share/cmf/schema/scm_prepare_database.sh mysql cm -hlocalhost -uroot -pxxxx --scm-host localhost scm scm scm agent 配置 123vi /opt/cm-5.13.3/etc/cloudera-scm-agent/config.ini修改server_host为主节点的主机名 同步agent 到其他节点 同步到hadoop1-hadoop5 1scp -r /opt/cm-5.13.3 root@hadoop1:/opt/ 在所有节点创建cloudera-scm用户 1useradd --system --home=/opt/cm-5.13.3/run/cloudera-scm-server/ --no-create-home --shell=/bin/false --comment &quot;Cloudera SCM User&quot; cloudera-scm 6、 准备 CDH parcels1234567将下载的CDH相关parcel copy到/opt/cloudera/parcel-repocp CDH-5.13.3-1.cdh5.13.3.p0.2-el7.parcel /opt/cloudera/parcel-repo/cp CDH-5.13.3-1.cdh5.13.3.p0.2-el7.parcel.sha1 /opt/cloudera/parcel-repo/cp manifest.json /opt/cloudera/parcel-repo/修改CDH-5.13.3-1.cdh5.13.3.p0.2-el7.parcel.sha1 为CDH-5.13.3-1.cdh5.13.3.p0.2-el7.parcel.shamv CDH-5.13.3-1.cdh5.13.3.p0.2-el7.parcel.sha1 CDH-5.13.3-1.cdh5.13.3.p0.2-el7.parcel.sha 启动cm12345相关启动脚本 主节点启动server+agent 其他节点启动agent通过/opt/cm-5.13.3/etc/init.d/cloudera-scm-server start启动服务端。通过/opt/cm-5.13.3/etc/init.d/cloudera-scm-agent start启动Agent服务。 cdh 安装配置启动cm后就可以在cm控制台中安装cdh并配置了。由于当时安装时没有相关截图，就不写啦期间会遇到连接mysql时报错，需要相应python包的安装其他问题通过提示可解决","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://www.blog.littlepig.tech/categories/hadoop/"}],"tags":[{"name":"技术","slug":"技术","permalink":"http://www.blog.littlepig.tech/tags/技术/"}]}]}